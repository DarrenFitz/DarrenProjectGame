<html>

  <head>
    <meta charset="UTF-8">
    <title>Canvas</title>

    <style type="text/css">
      body {
          background-color: white;        
            }
        canvas{border: #666 3px solid;
        }
    </style>
  </head>
    
    <body> 
    
        <canvas id="darrenCanvas" width="800" height="600"> </canvas>
        
        <script>
            //Put all my javascript code here
            // Gets a handle to the element with id darrenCanvas.
            var canvas = document.getElementById("darrenCanvas");
            // Set the canvas up for drawing in 2D.
            var ctx = canvas.getContext("2d");
            
            //ball object to add variables
            var ball = {
                position: {x: canvas.width/2, y: canvas.height-30 }
                ,radius: 10
                ,velocity: {x:5, y: -5}
            }
            
            //paddle object for variables
            var paddle = {
                width: 100
                ,height: 7
                ,position: { x: (canvas.width - 100)/2}
            }
            
            //drawBall function to create the ball
            function drawBall(){
                ctx.beginPath();
                ctx.arc(ball.position.x,ball.position.y,ball.radius,0,2*Math.PI);
                ctx.fillStyle = "rgb(45,225,0)";
                ctx.fill();
                ctx.stroke(); 
                ctx.closePath();
                
            } 
            
            //function to create the paddle
            function drawPaddle(){
                ctx.beginPath();
                ctx.rect(paddle.position.x, canvas.height - paddle.height, paddle.width, paddle.height);
                ctx.fillStyle = "rgb(0,225,0)";
                ctx.fill();
                ctx.closePath();
            }
            
            //event function to move the paddle left or right
            window.addEventListener("keydown", function(event) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                if (event.keyCode == 39)
                  paddle.position.x += 15;
                else if (event.keyCode == 37)
                  paddle.position.x -= 15;
              });
            
            function repeat(){ //function utilising requestAnimationFrame
                
                //clear the previous ball after new ball animation is created
                ctx.clearRect(0,0, canvas.width, canvas.height);
                
                //updates the position of the ball
                ball.position.x += ball.velocity.x;
                ball.position.y += ball.velocity.y;
                
                //keep ball from leaving the canvas
                if(ball.position.x <= ball.radius || ball.position.x >= canvas.width - ball.radius)
                    ball.velocity.x = -ball.velocity.x;
                
                //Change to only allow paddle to execute return ball at bottom
                if(ball.position.y <= ball.radius )
                    ball.velocity.y = -ball.velocity.y;
                //when ball hits paddle the velocity direction changes and ball bounce back off paddle
                if((ball.position.y >= canvas.height - paddle.height - ball.radius) 
                   && (ball.position.x >= paddle.position.x) 
                   && (ball.position.x <= paddle.position.x + paddle.width))
                    ball.velocity.y = -ball.velocity.y;
                    
                //if ball leaves canvas at bottom because it didnt hit paddle display "GAME OVER"
                else if (ball.position.y > canvas.height){
                        alert("GAME OVER");
                        document.location.reload();
                    }
                
                //method that is called to draw circle to screen
                drawBall();
                //call drawPaddle method to dispaly paddle
                drawPaddle();
                window.requestAnimationFrame(repeat);
                
            }   
            //utilise requestAnimationFrame to get animation to repeat and work 
            window.requestAnimationFrame(repeat);
            
            
        </script>
    
    </body>
        
  
</html>